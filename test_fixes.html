<!DOCTYPE html>
<html lang="zh-cn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🔧 前端修复验证测试</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 多重Font Awesome备用 -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet" onerror="this.onerror=null;this.href='https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css';">
    <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet" media="none" onload="if(media!='all')media='all'">
    <noscript><link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css" rel="stylesheet"></noscript>
    
    <link rel="stylesheet" href="/static/css/themes.css">
    <style>
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', Roboto, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 2rem auto;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        .test-section {
            background: var(--card-bg, #ffffff);
            border: 1px solid var(--border-color, #e5e5e5);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }
        .emoji-test {
            font-size: 2rem;
            line-height: 1.5;
            margin: 1rem 0;
        }
        .icon-test {
            font-size: 1.5rem;
            margin: 0.5rem;
        }
        .theme-indicator {
            padding: 1rem;
            border-radius: 4px;
            background: var(--primary-color, #6c757d);
            color: var(--primary-text, #ffffff);
            margin: 1rem 0;
        }
        .status-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 500;
            margin: 0 5px;
        }
        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }
        .test-emoji-inline {
            font-size: 1.2rem;
            margin: 0 0.2rem;
        }
    </style>
</head>
<body class="theme-classic">
    <div class="test-container">
        <h1>🚀 前端修复验证测试</h1>
        <p class="text-muted">验证 Emoji 显示和主题切换修复效果</p>
        
        <!-- 修复状态概览 -->
        <div class="test-section">
            <h2>📊 修复状态概览</h2>
            <div class="mb-3">
                <span class="status-indicator status-success">✅ Emoji字体回退已添加</span>
                <span class="status-indicator status-success">✅ 多重Font Awesome备用</span>
                <span class="status-indicator status-success">✅ 主题冲突已解决</span>
            </div>
            <p><strong>预期结果：</strong>所有表情符号应正常显示，不再出现 ❌ 符号</p>
        </div>
        
        <!-- 主题切换测试区域 -->
        <div class="test-section">
            <h2>🎨 主题切换测试</h2>
            <p>当前主题指示器：</p>
            <div class="theme-indicator">
                这个区域会根据主题变色 - 检查颜色变化
            </div>
            
            <!-- 主题切换器容器 -->
            <div id="navbar-theme-selector"></div>
        </div>
        
        <!-- 表情符号显示测试 -->
        <div class="test-section">
            <h2>😀 表情符号显示测试</h2>
            <div class="emoji-test">
                <p><strong>笑脸类：</strong>😀 😂 🤣 😊 😍 🥰 😘 😋 😎 🤔 😴 😅 😆 🤪 🤯</p>
                <p><strong>动物类：</strong>🐶 🐱 🐭 🐹 🐰 🦊 🐻 🐼 🐨 🐯 🦁 🐮 🐷 🐸 🐵</p>
                <p><strong>食物类：</strong>🍎 🍌 🍇 🍓 🍑 🍒 🥝 🍅 🥕 🌽 🥖 🍕 🍔 🍟 🌮</p>
                <p><strong>符号类：</strong>❤️ 💙 💚 💛 🧡 💜 🖤 🤍 💔 ❣️ 💕 💖 💗 💘 💝</p>
                <p><strong>活动类：</strong>⚽ 🏀 🏈 ⚾ 🎾 🏐 🏉 🎱 🏓 🏸 🥅 🏒 🏑 🏏 ⛳</p>
            </div>
            <div class="alert alert-info">
                <strong>测试说明：</strong>如果看到任何 <span style="font-family: monospace;">□</span> 或 ❌ 符号，说明Emoji字体仍有问题。
            </div>
        </div>
        
        <!-- Font Awesome 图标测试 -->
        <div class="test-section">
            <h2>🔧 Font Awesome 图标测试</h2>
            <div class="icon-test">
                <p><strong>基础图标：</strong></p>
                <i class="fa-solid fa-home"></i> 首页 <span class="test-emoji-inline">🏠</span>
                <i class="fa-solid fa-user"></i> 用户 <span class="test-emoji-inline">👤</span>
                <i class="fa-solid fa-cog"></i> 设置 <span class="test-emoji-inline">⚙️</span>
                <i class="fa-solid fa-heart"></i> 喜欢 <span class="test-emoji-inline">❤️</span>
                <i class="fa-solid fa-star"></i> 收藏 <span class="test-emoji-inline">⭐</span>
                <i class="fa-solid fa-search"></i> 搜索 <span class="test-emoji-inline">🔍</span>
                <i class="fa-solid fa-bell"></i> 通知 <span class="test-emoji-inline">🔔</span>
                <i class="fa-solid fa-envelope"></i> 邮件 <span class="test-emoji-inline">✉️</span>
            </div>
            <div class="alert alert-warning">
                <strong>注意：</strong>如果Font Awesome加载失败，图标应自动显示右侧的表情符号作为后备。
            </div>
        </div>
        
        <!-- 测试结果说明 -->
        <div class="test-section">
            <h2>✅ 测试验证清单</h2>
            <div class="row">
                <div class="col-md-6">
                    <h5>✅ 表情符号验证</h5>
                    <ul class="list-unstyled">
                        <li>☐ 所有表情符号正常显示</li>
                        <li>☐ 无矩形框 ❌ 符号</li>
                        <li>☐ 颜色显示正确</li>
                        <li>☐ 大小比例正常</li>
                    </ul>
                </div>
                <div class="col-md-6">
                    <h5>🎨 主题切换验证</h5>
                    <ul class="list-unstyled">
                        <li>☐ 主题切换器显示正常</li>
                        <li>☐ 点击后主题正确变化</li>
                        <li>☐ 主题指示器颜色变化</li>
                        <li>☐ 无JavaScript错误</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <!-- 技术信息 -->
        <div class="test-section">
            <h2>🔬 技术信息</h2>
            <p><strong>字体堆栈：</strong> 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji', Roboto, sans-serif</p>
            <p><strong>图标回退：</strong>CSS ::after 伪元素自动激活</p>
            <p><strong>主题系统：</strong>CSS 自定义属性 + body 类切换</p>
        </div>
    </div>

    <!-- 脚本加载 -->
    <script src="/static/js/theme-manager.js"></script>
    <script src="/static/js/icon-manager.js"></script>
    <script src="/static/js/ux-enhancer.js"></script>
    
    <script>
        // 初始化所有功能
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🔧 开始初始化前端测试系统...');
            
            // 初始化主题管理器
            if (typeof ThemeManager !== 'undefined') {
                const themeManager = new ThemeManager();
                console.log('✅ 主题管理器已初始化');
            } else {
                console.error('❌ ThemeManager 类未找到');
            }
            
            // 初始化图标管理器
            if (typeof IconManager !== 'undefined') {
                const iconManager = new IconManager();
                console.log('✅ 图标管理器已初始化');
            } else {
                console.error('❌ IconManager 类未找到');
            }
            
            // 初始化UX增强器
            if (typeof UXEnhancer !== 'undefined') {
                const uxEnhancer = new UXEnhancer();
                console.log('✅ UX增强器已初始化');
            } else {
                console.error('❌ UXEnhancer 类未找到');
            }
            
            // 检测字体支持
            const testEmoji = document.createElement('span');
            testEmoji.innerHTML = '😀';
            testEmoji.style.font = '16px monospace';
            document.body.appendChild(testEmoji);
            const emojiWidth = testEmoji.offsetWidth;
            document.body.removeChild(testEmoji);
            
            console.log('📊 Emoji字体检测:', emojiWidth > 0 ? '支持' : '不支持');
            console.log('🎉 所有功能初始化完成！');
        });
        
        // Font Awesome 加载检测
        const faCheckInterval = setInterval(() => {
            const testFA = document.createElement('i');
            testFA.className = 'fas fa-home';
            testFA.style.cssText = 'opacity: 0; position: absolute;';
            document.body.appendChild(testFA);
            
            const computed = window.getComputedStyle(testFA, ':before');
            const content = computed.getPropertyValue('content');
            
            if (content && content !== 'none' && content !== '""') {
                console.log('✅ Font Awesome 已正确加载');
                clearInterval(faCheckInterval);
            } else {
                console.log('⏳ Font Awesome 仍在加载中...');
            }
            
            document.body.removeChild(testFA);
        }, 1000);
        
        // 5秒后停止检测
        setTimeout(() => {
            clearInterval(faCheckInterval);
            console.log('🔍 Font Awesome 加载检测已停止');
        }, 5000);
    </script>
</body>
</html>